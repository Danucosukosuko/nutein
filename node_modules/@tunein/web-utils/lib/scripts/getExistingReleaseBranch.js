import { range } from 'es-toolkit';
export function getExistingReleaseBranch(execSync, prompt) {
    const existingReleaseHotfixBranches = execSync('git branch --color=never -r | grep -E "release--|hotfix--|minor-release--"')
        .toString()
        .replace(/ /g, '')
        .replace(/origin\//g, '')
        .split('\n')
        .filter(Boolean);
    if (existingReleaseHotfixBranches.length > 1) {
        const selectionMap = {};
        console.log('There is more than one release/hotfix branch present. You should clean them up. In the meantime, select the one you want:');
        console.log('\n');
        const selectionPrompt = existingReleaseHotfixBranches.map((branchName, index) => {
            selectionMap[Number.parseInt(index, 10)] = branchName;
            return `${index}: ${branchName}`;
        });
        const userSelection = Number.parseInt(prompt(`${selectionPrompt.join('\n')}\nType the number and hit enter: `), 10);
        if (!range(0, existingReleaseHotfixBranches.length).includes(userSelection)) {
            console.error('You need to select an appropriate number. Try again!');
            process.exit(1);
        }
        return selectionMap[userSelection];
    }
    return existingReleaseHotfixBranches[0];
}
